<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PCA via SVD and via AffinityMatcher &mdash; TorchDR 0.0.0-alpha documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=61a4c737" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />

  
    <link rel="shortcut icon" href="../../_static/logo.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=8e37ee27"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Math notations" href="../../torchdr.notation.html" />
    <link rel="prev" title="Toy examples" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/torchdr_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../torchdr.overview.html">DR estimators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../torchdr.affinities.html">Affinities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../torchdr.neighbor-embedding.html">Neighbor embedding algorithms</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Toy examples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#basics">Basics</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">PCA via SVD and via AffinityMatcher</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#load-toy-images">Load toy images</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pca-via-svd">PCA via SVD</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pca-via-affinitymatcher">PCA via AffinityMatcher</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../torchdr.notation.html">Math notations</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">TorchDR</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Toy examples</a></li>
      <li class="breadcrumb-item active">PCA via SVD and via AffinityMatcher</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/auto_examples/basics/demo_pca_via_affinity_matcher.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-basics-demo-pca-via-affinity-matcher-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="pca-via-svd-and-via-affinitymatcher">
<span id="sphx-glr-auto-examples-basics-demo-pca-via-affinity-matcher-py"></span><h1>PCA via SVD and via AffinityMatcher<a class="headerlink" href="#pca-via-svd-and-via-affinitymatcher" title="Link to this heading"></a></h1>
<p>In this example, we show how to compute a PCA embedding using the closed form
and using the AffinityMatcher class. Both approaches lead to the same solution.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_digits</span>

<span class="kn">from</span> <span class="nn">torchdr.spectral</span> <span class="kn">import</span> <a href="https://docs.python.org/3.4/library/abc.html#abc.ABC" title="abc.ABC" class="sphx-glr-backref-module-abc sphx-glr-backref-type-py-class"><span class="n">PCA</span></a>
<span class="kn">from</span> <span class="nn">torchdr</span> <span class="kn">import</span> <a href="https://docs.python.org/3.4/library/abc.html#abc.ABC" title="abc.ABC" class="sphx-glr-backref-module-abc sphx-glr-backref-type-py-class"><span class="n">AffinityMatcher</span></a><span class="p">,</span> <a href="https://docs.python.org/3.4/library/abc.html#abc.ABC" title="abc.ABC" class="sphx-glr-backref-module-abc sphx-glr-backref-type-py-class"><span class="n">ScalarProductAffinity</span></a>
</pre></div>
</div>
<section id="load-toy-images">
<h2>Load toy images<a class="headerlink" href="#load-toy-images" title="Link to this heading"></a></h2>
<p>First, let’s load 5 classes of the digits dataset from sklearn.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">digits</span> <span class="o">=</span> <span class="n">load_digits</span><span class="p">(</span><span class="n">n_class</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">X</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">digits</span><span class="o">.</span><span class="n">data</span></a>
</pre></div>
</div>
</section>
<section id="pca-via-svd">
<h2>PCA via SVD<a class="headerlink" href="#pca-via-svd" title="Link to this heading"></a></h2>
<p>Let us perform PCA using the closed form solution given by the
Singular Value Decomposition (SVD).</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Z_svd</span></a> <span class="o">=</span> <a href="https://docs.python.org/3.4/library/abc.html#abc.ABC" title="abc.ABC" class="sphx-glr-backref-module-abc sphx-glr-backref-type-py-class"><span class="n">PCA</span></a><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">X</span></a><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Z_svd</span></a><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Z_svd</span></a><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">digits</span><span class="o">.</span><span class="n">target</span></a><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;PCA via SVD&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_demo_pca_via_affinity_matcher_001.png" srcset="../../_images/sphx_glr_demo_pca_via_affinity_matcher_001.png" alt="PCA via SVD" class = "sphx-glr-single-img"/></section>
<section id="pca-via-affinitymatcher">
<h2>PCA via AffinityMatcher<a class="headerlink" href="#pca-via-affinitymatcher" title="Link to this heading"></a></h2>
<p>Now, let us perform PCA using the AffinityMatcher class by using the scaler product
affinity for both input data and embeddings, and the square loss as global objective.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <a href="https://docs.python.org/3.4/library/abc.html#abc.ABC" title="abc.ABC" class="sphx-glr-backref-module-abc sphx-glr-backref-type-py-class"><span class="n">AffinityMatcher</span></a><span class="p">(</span>
    <span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">affinity_in</span><span class="o">=</span><a href="https://docs.python.org/3.4/library/abc.html#abc.ABC" title="abc.ABC" class="sphx-glr-backref-module-abc sphx-glr-backref-type-py-class"><span class="n">ScalarProductAffinity</span></a><span class="p">(</span><span class="n">centering</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">affinity_out</span><span class="o">=</span><a href="https://docs.python.org/3.4/library/abc.html#abc.ABC" title="abc.ABC" class="sphx-glr-backref-module-abc sphx-glr-backref-type-py-class"><span class="n">ScalarProductAffinity</span></a><span class="p">(),</span>
    <span class="n">loss_fn</span><span class="o">=</span><span class="s2">&quot;square_loss&quot;</span><span class="p">,</span>
    <span class="n">init</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span><span class="p">,</span>
    <span class="n">lr</span><span class="o">=</span><span class="mf">1e1</span><span class="p">,</span>
    <span class="n">max_iter</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">keops</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Z_am</span></a> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">X</span></a><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Z_am</span></a><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Z_am</span></a><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">digits</span><span class="o">.</span><span class="n">target</span></a><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;PCA via AffinityMatcher&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_demo_pca_via_affinity_matcher_002.png" srcset="../../_images/sphx_glr_demo_pca_via_affinity_matcher_002.png" alt="PCA via AffinityMatcher" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>  0%|          | 0/50 [00:00&lt;?, ?it/s][KeOps] Generating code for Sum_Reduction reduction (with parameters 0) of formula (-(-(a|b)+f*Step(e-(c-d)**2))--(-(g|h)+l*Step(k-(i-j)**2)))**2 with a=Var(0,64,0), b=Var(1,64,1), c=Var(2,1,0), d=Var(3,1,1), e=Var(4,1,2), f=Var(5,1,2), g=Var(6,2,0), h=Var(7,2,1), i=Var(8,1,0), j=Var(9,1,1), k=Var(10,1,2), l=Var(11,1,2) ... OK
[pyKeOps] Compiling pykeops cpp 242b2fe2af module ... OK
[KeOps] Generating code for Sum_Reduction reduction (with parameters 0) of formula -2*((m*h)*(-(-(a|b)+f*Step(e-(c-d)**2))--(-(g|h)+l*Step(k-(i-j)**2)))) with a=Var(0,64,0), b=Var(1,64,1), c=Var(2,1,0), d=Var(3,1,1), e=Var(4,1,2), f=Var(5,1,2), g=Var(6,2,0), h=Var(7,2,1), i=Var(8,1,0), j=Var(9,1,1), k=Var(10,1,2), l=Var(11,1,2), m=Var(12,1,0) ... OK
[pyKeOps] Compiling pykeops cpp 5801ddae38 module ... OK
[KeOps] Generating code for Sum_Reduction reduction (with parameters 1) of formula -2*((m*g)*(-(-(a|b)+f*Step(e-(c-d)**2))--(-(g|h)+l*Step(k-(i-j)**2)))) with a=Var(0,64,0), b=Var(1,64,1), c=Var(2,1,0), d=Var(3,1,1), e=Var(4,1,2), f=Var(5,1,2), g=Var(6,2,0), h=Var(7,2,1), i=Var(8,1,0), j=Var(9,1,1), k=Var(10,1,2), l=Var(11,1,2), m=Var(12,1,0) ... OK
[pyKeOps] Compiling pykeops cpp 57c415276b module ... OK
/home/circleci/.local/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:156: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)

Loss : 1.35e+11:   0%|          | 0/50 [00:13&lt;?, ?it/s]
Loss : 1.35e+11:   2%|▏         | 1/50 [00:13&lt;10:52, 13.31s/it]
Loss : 9.72e+10:   2%|▏         | 1/50 [00:13&lt;10:52, 13.31s/it]
Loss : 9.72e+10:   4%|▍         | 2/50 [00:13&lt;04:37,  5.77s/it]
Loss : 9.94e+10:   4%|▍         | 2/50 [00:14&lt;04:37,  5.77s/it]
Loss : 9.94e+10:   6%|▌         | 3/50 [00:14&lt;02:38,  3.37s/it]
Loss : 7.84e+10:   6%|▌         | 3/50 [00:14&lt;02:38,  3.37s/it]
Loss : 7.84e+10:   8%|▊         | 4/50 [00:14&lt;01:41,  2.20s/it]
Loss : 8.24e+10:   8%|▊         | 4/50 [00:15&lt;01:41,  2.20s/it]
Loss : 8.24e+10:  10%|█         | 5/50 [00:15&lt;01:11,  1.59s/it]
Loss : 8.05e+10:  10%|█         | 5/50 [00:15&lt;01:11,  1.59s/it]
Loss : 8.05e+10:  12%|█▏        | 6/50 [00:15&lt;00:54,  1.25s/it]
Loss : 6.82e+10:  12%|█▏        | 6/50 [00:16&lt;00:54,  1.25s/it]
Loss : 6.82e+10:  14%|█▍        | 7/50 [00:16&lt;00:44,  1.04s/it]
Loss : 5.69e+10:  14%|█▍        | 7/50 [00:16&lt;00:44,  1.04s/it]
Loss : 5.69e+10:  16%|█▌        | 8/50 [00:16&lt;00:35,  1.20it/s]
Loss : 5.29e+10:  16%|█▌        | 8/50 [00:17&lt;00:35,  1.20it/s]
Loss : 5.29e+10:  18%|█▊        | 9/50 [00:17&lt;00:28,  1.43it/s]
Loss : 4.92e+10:  18%|█▊        | 9/50 [00:17&lt;00:28,  1.43it/s]
Loss : 4.92e+10:  20%|██        | 10/50 [00:17&lt;00:25,  1.57it/s]
Loss : 4.66e+10:  20%|██        | 10/50 [00:18&lt;00:25,  1.57it/s]
Loss : 4.66e+10:  22%|██▏       | 11/50 [00:18&lt;00:24,  1.60it/s]
Loss : 4.52e+10:  22%|██▏       | 11/50 [00:18&lt;00:24,  1.60it/s]
Loss : 4.52e+10:  24%|██▍       | 12/50 [00:18&lt;00:21,  1.80it/s]
Loss : 4.40e+10:  24%|██▍       | 12/50 [00:19&lt;00:21,  1.80it/s]
Loss : 4.40e+10:  26%|██▌       | 13/50 [00:19&lt;00:18,  1.96it/s]
Loss : 4.27e+10:  26%|██▌       | 13/50 [00:19&lt;00:18,  1.96it/s]
Loss : 4.27e+10:  28%|██▊       | 14/50 [00:19&lt;00:17,  2.10it/s]
Loss : 4.15e+10:  28%|██▊       | 14/50 [00:20&lt;00:17,  2.10it/s]
Loss : 4.15e+10:  30%|███       | 15/50 [00:20&lt;00:16,  2.07it/s]
Loss : 4.09e+10:  30%|███       | 15/50 [00:20&lt;00:16,  2.07it/s]
Loss : 4.09e+10:  32%|███▏      | 16/50 [00:20&lt;00:16,  2.05it/s]
Loss : 4.08e+10:  32%|███▏      | 16/50 [00:21&lt;00:16,  2.05it/s]
Loss : 4.08e+10:  34%|███▍      | 17/50 [00:21&lt;00:16,  2.03it/s]
Loss : 4.06e+10:  34%|███▍      | 17/50 [00:21&lt;00:16,  2.03it/s]
Loss : 4.06e+10:  36%|███▌      | 18/50 [00:21&lt;00:14,  2.15it/s]
Loss : 4.06e+10:  36%|███▌      | 18/50 [00:22&lt;00:14,  2.15it/s]
Loss : 4.06e+10:  38%|███▊      | 19/50 [00:22&lt;00:15,  1.98it/s]
Loss : 4.04e+10:  38%|███▊      | 19/50 [00:22&lt;00:15,  1.98it/s]
Loss : 4.04e+10:  40%|████      | 20/50 [00:22&lt;00:14,  2.11it/s]
Loss : 3.96e+10:  40%|████      | 20/50 [00:23&lt;00:14,  2.11it/s]
Loss : 3.96e+10:  42%|████▏     | 21/50 [00:23&lt;00:15,  1.85it/s]
Loss : 3.83e+10:  42%|████▏     | 21/50 [00:23&lt;00:15,  1.85it/s]
Loss : 3.83e+10:  44%|████▍     | 22/50 [00:23&lt;00:13,  2.00it/s]
Loss : 3.70e+10:  44%|████▍     | 22/50 [00:24&lt;00:13,  2.00it/s]
Loss : 3.70e+10:  46%|████▌     | 23/50 [00:24&lt;00:14,  1.89it/s]
Loss : 3.61e+10:  46%|████▌     | 23/50 [00:24&lt;00:14,  1.89it/s]
Loss : 3.61e+10:  48%|████▊     | 24/50 [00:24&lt;00:14,  1.82it/s]
Loss : 3.55e+10:  48%|████▊     | 24/50 [00:25&lt;00:14,  1.82it/s]
Loss : 3.55e+10:  50%|█████     | 25/50 [00:25&lt;00:13,  1.86it/s]
Loss : 3.51e+10:  50%|█████     | 25/50 [00:25&lt;00:13,  1.86it/s]
Loss : 3.51e+10:  52%|█████▏    | 26/50 [00:25&lt;00:13,  1.81it/s]
Loss : 3.53e+10:  52%|█████▏    | 26/50 [00:26&lt;00:13,  1.81it/s]
Loss : 3.53e+10:  54%|█████▍    | 27/50 [00:26&lt;00:11,  1.96it/s]
Loss : 3.55e+10:  54%|█████▍    | 27/50 [00:26&lt;00:11,  1.96it/s]
Loss : 3.55e+10:  56%|█████▌    | 28/50 [00:26&lt;00:11,  1.97it/s]
Loss : 3.57e+10:  56%|█████▌    | 28/50 [00:27&lt;00:11,  1.97it/s]
Loss : 3.57e+10:  58%|█████▊    | 29/50 [00:27&lt;00:10,  1.98it/s]
Loss : 3.56e+10:  58%|█████▊    | 29/50 [00:27&lt;00:10,  1.98it/s]
Loss : 3.56e+10:  60%|██████    | 30/50 [00:27&lt;00:10,  1.88it/s]
Loss : 3.53e+10:  60%|██████    | 30/50 [00:28&lt;00:10,  1.88it/s]
Loss : 3.53e+10:  62%|██████▏   | 31/50 [00:28&lt;00:09,  1.91it/s]
Loss : 3.49e+10:  62%|██████▏   | 31/50 [00:28&lt;00:09,  1.91it/s]
Loss : 3.49e+10:  64%|██████▍   | 32/50 [00:28&lt;00:08,  2.05it/s]
Loss : 3.45e+10:  64%|██████▍   | 32/50 [00:29&lt;00:08,  2.05it/s]
Loss : 3.45e+10:  66%|██████▌   | 33/50 [00:29&lt;00:07,  2.17it/s]
Loss : 3.42e+10:  66%|██████▌   | 33/50 [00:29&lt;00:07,  2.17it/s]
Loss : 3.42e+10:  68%|██████▊   | 34/50 [00:29&lt;00:07,  2.12it/s]
Loss : 3.40e+10:  68%|██████▊   | 34/50 [00:30&lt;00:07,  2.12it/s]
Loss : 3.40e+10:  70%|███████   | 35/50 [00:30&lt;00:07,  2.08it/s]
Loss : 3.39e+10:  70%|███████   | 35/50 [00:30&lt;00:07,  2.08it/s]
Loss : 3.39e+10:  72%|███████▏  | 36/50 [00:30&lt;00:06,  2.06it/s]
Loss : 3.39e+10:  72%|███████▏  | 36/50 [00:31&lt;00:06,  2.06it/s]
Loss : 3.39e+10:  74%|███████▍  | 37/50 [00:31&lt;00:06,  2.04it/s]
Loss : 3.38e+10:  74%|███████▍  | 37/50 [00:31&lt;00:06,  2.04it/s]
Loss : 3.38e+10:  76%|███████▌  | 38/50 [00:31&lt;00:05,  2.15it/s]
Loss : 3.38e+10:  76%|███████▌  | 38/50 [00:32&lt;00:05,  2.15it/s]
Loss : 3.38e+10:  78%|███████▊  | 39/50 [00:32&lt;00:05,  2.11it/s]
Loss : 3.37e+10:  78%|███████▊  | 39/50 [00:32&lt;00:05,  2.11it/s]
Loss : 3.37e+10:  80%|████████  | 40/50 [00:32&lt;00:04,  2.08it/s]
Loss : 3.37e+10:  80%|████████  | 40/50 [00:33&lt;00:04,  2.08it/s]
Loss : 3.37e+10:  82%|████████▏ | 41/50 [00:33&lt;00:04,  2.05it/s]
Loss : 3.36e+10:  82%|████████▏ | 41/50 [00:33&lt;00:04,  2.05it/s]
Loss : 3.36e+10:  84%|████████▍ | 42/50 [00:33&lt;00:03,  2.03it/s]
Loss : 3.36e+10:  84%|████████▍ | 42/50 [00:33&lt;00:03,  2.03it/s]
Loss : 3.36e+10:  86%|████████▌ | 43/50 [00:33&lt;00:03,  2.15it/s]
Loss : 3.35e+10:  86%|████████▌ | 43/50 [00:34&lt;00:03,  2.15it/s]
Loss : 3.35e+10:  88%|████████▊ | 44/50 [00:34&lt;00:02,  2.24it/s]
Loss : 3.34e+10:  88%|████████▊ | 44/50 [00:34&lt;00:02,  2.24it/s]
Loss : 3.34e+10:  90%|█████████ | 45/50 [00:34&lt;00:02,  2.17it/s]
Loss : 3.33e+10:  90%|█████████ | 45/50 [00:35&lt;00:02,  2.17it/s]
Loss : 3.33e+10:  92%|█████████▏| 46/50 [00:35&lt;00:01,  2.25it/s]
Loss : 3.32e+10:  92%|█████████▏| 46/50 [00:35&lt;00:01,  2.25it/s]
Loss : 3.32e+10:  94%|█████████▍| 47/50 [00:35&lt;00:01,  2.18it/s]
Loss : 3.32e+10:  94%|█████████▍| 47/50 [00:36&lt;00:01,  2.18it/s]
Loss : 3.32e+10:  96%|█████████▌| 48/50 [00:36&lt;00:00,  2.12it/s]
Loss : 3.32e+10:  96%|█████████▌| 48/50 [00:36&lt;00:00,  2.12it/s]
Loss : 3.32e+10:  98%|█████████▊| 49/50 [00:36&lt;00:00,  2.22it/s]
Loss : 3.32e+10:  98%|█████████▊| 49/50 [00:37&lt;00:00,  2.22it/s]
Loss : 3.32e+10: 100%|██████████| 50/50 [00:37&lt;00:00,  2.30it/s]
Loss : 3.32e+10: 100%|██████████| 50/50 [00:37&lt;00:00,  1.35it/s]
</pre></div>
</div>
<p>We can see that we obtain the same PCA embedding (up to a rotation) using
both methods.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 38.521 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-basics-demo-pca-via-affinity-matcher-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/01119b09b904483a657e921d21bc15d1/demo_pca_via_affinity_matcher.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">demo_pca_via_affinity_matcher.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/3782b8d6c3b9610739919e42de4d08a1/demo_pca_via_affinity_matcher.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">demo_pca_via_affinity_matcher.py</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="Toy examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../torchdr.notation.html" class="btn btn-neutral float-right" title="Math notations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, TorchDR team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>